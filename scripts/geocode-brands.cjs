const { PrismaClient } = require('@prisma/client');

const prisma = new PrismaClient();

// CoordonnÃ©es des principales villes franÃ§aises
const CITY_COORDS = {
  'paris': { lat: 48.8566, lng: 2.3522 },
  'lyon': { lat: 45.7640, lng: 4.8357 },
  'marseille': { lat: 43.2965, lng: 5.3698 },
  'toulouse': { lat: 43.6047, lng: 1.4442 },
  'nice': { lat: 43.7102, lng: 7.2620 },
  'nantes': { lat: 47.2184, lng: -1.5536 },
  'strasbourg': { lat: 48.5734, lng: 7.7521 },
  'montpellier': { lat: 43.6108, lng: 3.8767 },
  'bordeaux': { lat: 44.8378, lng: -0.5792 },
  'lille': { lat: 50.6292, lng: 3.0573 },
  'rennes': { lat: 48.1173, lng: -1.6778 },
  'reims': { lat: 49.2583, lng: 4.0317 },
  'le havre': { lat: 49.4944, lng: 0.1079 },
  'saint-Ã©tienne': { lat: 45.4397, lng: 4.3872 },
  'saint-etienne': { lat: 45.4397, lng: 4.3872 },
  'toulon': { lat: 43.1242, lng: 5.9280 },
  'grenoble': { lat: 45.1885, lng: 5.7245 },
  'dijon': { lat: 47.3220, lng: 5.0415 },
  'angers': { lat: 47.4784, lng: -0.5632 },
  'nÃ®mes': { lat: 43.8367, lng: 4.3601 },
  'nimes': { lat: 43.8367, lng: 4.3601 },
  'villeurbanne': { lat: 45.7676, lng: 4.8799 },
  'clermont-ferrand': { lat: 45.7772, lng: 3.0870 },
  'le mans': { lat: 48.0061, lng: 0.1996 },
  'aix-en-provence': { lat: 43.5297, lng: 5.4474 },
  'brest': { lat: 48.3904, lng: -4.4861 },
  'tours': { lat: 47.3941, lng: 0.6848 },
  'amiens': { lat: 49.8941, lng: 2.2958 },
  'limoges': { lat: 45.8336, lng: 1.2611 },
  'annecy': { lat: 45.8992, lng: 6.1294 },
  'perpignan': { lat: 42.6887, lng: 2.8948 },
  'boulogne-billancourt': { lat: 48.8397, lng: 2.2399 },
  'metz': { lat: 49.1193, lng: 6.1757 },
  'besanÃ§on': { lat: 47.2378, lng: 6.0241 },
  'besancon': { lat: 47.2378, lng: 6.0241 },
  'orlÃ©ans': { lat: 47.9029, lng: 1.9039 },
  'orleans': { lat: 47.9029, lng: 1.9039 },
  'rouen': { lat: 49.4432, lng: 1.0999 },
  'mulhouse': { lat: 47.7508, lng: 7.3359 },
  'caen': { lat: 49.1829, lng: -0.3707 },
  'nancy': { lat: 48.6921, lng: 6.1844 },
  'saint-denis': { lat: 48.9362, lng: 2.3574 },
  'argenteuil': { lat: 48.9472, lng: 2.2467 },
  'montreuil': { lat: 48.8638, lng: 2.4483 },
  'roubaix': { lat: 50.6942, lng: 3.1746 },
  'tourcoing': { lat: 50.7262, lng: 3.1612 },
  'avignon': { lat: 43.9493, lng: 4.8055 },
  'dunkerque': { lat: 51.0343, lng: 2.3768 },
  'poitiers': { lat: 46.5802, lng: 0.3404 },
  'pau': { lat: 43.2951, lng: -0.3708 },
  'calais': { lat: 50.9513, lng: 1.8587 },
  'la rochelle': { lat: 46.1591, lng: -1.1520 },
  'cannes': { lat: 43.5528, lng: 7.0174 },
  'antibes': { lat: 43.5808, lng: 7.1239 },
  'saint-malo': { lat: 48.6493, lng: -2.0007 },
  'colmar': { lat: 48.0794, lng: 7.3558 },
  'troyes': { lat: 48.2973, lng: 4.0744 },
  'la roche-sur-yon': { lat: 46.6705, lng: -1.4269 },
  'chambÃ©ry': { lat: 45.5646, lng: 5.9178 },
  'chambery': { lat: 45.5646, lng: 5.9178 },
  'niort': { lat: 46.3238, lng: -0.4646 },
  'ajaccio': { lat: 41.9192, lng: 8.7386 },
  'bastia': { lat: 42.7029, lng: 9.4507 },
  'cholet': { lat: 47.0622, lng: -0.8788 },
  'vannes': { lat: 47.6559, lng: -2.7603 },
  'quimper': { lat: 47.9960, lng: -4.1024 },
  'lorient': { lat: 47.7483, lng: -3.3700 },
  'saint-brieuc': { lat: 48.5141, lng: -2.7600 },
  'saint-nazaire': { lat: 47.2733, lng: -2.2139 },
  'valence': { lat: 44.9334, lng: 4.8924 },
  'auxerre': { lat: 47.7986, lng: 3.5673 },
  'bourges': { lat: 47.0810, lng: 2.3988 },
  'chartres': { lat: 48.4469, lng: 1.4891 },
  'Ã©pinal': { lat: 48.1725, lng: 6.4499 },
  'epinal': { lat: 48.1725, lng: 6.4499 },
  'bÃ©ziers': { lat: 43.3442, lng: 3.2150 },
  'beziers': { lat: 43.3442, lng: 3.2150 },
  'saint-jean-de-monts': { lat: 46.7939, lng: -2.0600 },
  'cognac': { lat: 45.6958, lng: -0.3292 },
  'bayonne': { lat: 43.4929, lng: -1.4748 },
  'biarritz': { lat: 43.4832, lng: -1.5586 },
  'arcachon': { lat: 44.6606, lng: -1.1681 },
  'lourdes': { lat: 43.0950, lng: -0.0483 },
  'carcassonne': { lat: 43.2130, lng: 2.3491 },
  'albi': { lat: 43.9298, lng: 2.1480 },
  'rodez': { lat: 44.3516, lng: 2.5730 },
  'aurillac': { lat: 44.9261, lng: 2.4406 },
  'le puy-en-velay': { lat: 45.0429, lng: 3.8853 },
  'vichy': { lat: 46.1263, lng: 3.4269 },
  'thiers': { lat: 45.8575, lng: 3.5486 },
  'issoire': { lat: 45.5439, lng: 3.2497 },
  'chamaliÃ¨res': { lat: 45.7736, lng: 3.0636 },
  'saint-flour': { lat: 45.0341, lng: 3.0936 },
  'moulins': { lat: 46.5644, lng: 3.3327 },
  'montluÃ§on': { lat: 46.3400, lng: 2.6000 },
  'oyonnax': { lat: 46.2558, lng: 5.6556 },
  'bourg-en-bresse': { lat: 46.2056, lng: 5.2256 },
  'belfort': { lat: 47.6400, lng: 6.8600 },
  'lons-le-saunier': { lat: 46.6753, lng: 5.5514 },
  'dole': { lat: 47.0956, lng: 5.4972 },
  'vesoul': { lat: 47.6200, lng: 6.1500 },
  'nevers': { lat: 46.9900, lng: 3.1600 },
  'cosne-cours-sur-loire': { lat: 47.4106, lng: 2.9253 },
  'chÃ¢teauroux': { lat: 46.8103, lng: 1.6911 },
  'chateauroux': { lat: 46.8103, lng: 1.6911 },
  'blois': { lat: 47.5861, lng: 1.3359 },
  'vendÃ´me': { lat: 47.7928, lng: 1.0656 },
  'romorantin-lanthenay': { lat: 47.3564, lng: 1.7461 },
  'dreux': { lat: 48.7361, lng: 1.3664 },
  'nogent-le-rotrou': { lat: 48.3217, lng: 0.8219 },
  'Ã©vreux': { lat: 49.0269, lng: 1.1508 },
  'evreux': { lat: 49.0269, lng: 1.1508 },
  'vernon': { lat: 49.0928, lng: 1.4869 },
  'bernay': { lat: 49.0897, lng: 0.5989 },
  'fÃ©camp': { lat: 49.7578, lng: 0.3797 },
  'fecamp': { lat: 49.7578, lng: 0.3797 },
  'dieppe': { lat: 49.9250, lng: 1.0800 },
  'elbeuf': { lat: 49.2867, lng: 1.0100 },
  'cherbourg': { lat: 49.6337, lng: -1.6222 },
  'granville': { lat: 48.8378, lng: -1.5969 },
  'coutances': { lat: 49.0469, lng: -1.4419 },
  'saint-lÃ´': { lat: 49.1167, lng: -1.0833 },
  'saint-lo': { lat: 49.1167, lng: -1.0833 },
  'alenÃ§on': { lat: 48.4322, lng: 0.0911 },
  'alencon': { lat: 48.4322, lng: 0.0911 },
  'flers': { lat: 48.7500, lng: -0.5667 },
  'lisieux': { lat: 49.1461, lng: 0.2264 },
  'honfleur': { lat: 49.4181, lng: 0.2331 },
  'deauville': { lat: 49.3583, lng: 0.0761 },
  'bayeux': { lat: 49.2764, lng: -0.7022 },
  'laval': { lat: 48.0733, lng: -0.7689 },
  'mayenne': { lat: 48.3000, lng: -0.6167 },
  'chÃ¢teau-gontier': { lat: 47.8267, lng: -0.7033 },
  'sablÃ©-sur-sarthe': { lat: 47.8400, lng: -0.3333 },
  'la flÃ¨che': { lat: 47.6975, lng: -0.0772 },
  'mamers': { lat: 48.3508, lng: 0.3700 },
  'saumur': { lat: 47.2600, lng: -0.0769 },
  'segrÃ©': { lat: 47.6844, lng: -0.8683 },
  'fontenay-le-comte': { lat: 46.4669, lng: -0.8067 },
  'les sables-d\'olonne': { lat: 46.4974, lng: -1.7830 },
  'challans': { lat: 46.8467, lng: -1.8783 },
  'luÃ§on': { lat: 46.4536, lng: -1.1669 },
  'bressuire': { lat: 46.8400, lng: -0.4900 },
  'parthenay': { lat: 46.6500, lng: -0.2500 },
  'thouars': { lat: 46.9758, lng: -0.2150 },
  'rochefort': { lat: 45.9422, lng: -0.9583 },
  'saintes': { lat: 45.7464, lng: -0.6333 },
  'royan': { lat: 45.6208, lng: -1.0283 },
  'jonzac': { lat: 45.4464, lng: -0.4311 },
  'saint-jean-d\'angÃ©ly': { lat: 45.9428, lng: -0.5203 },
  'angoulÃªme': { lat: 45.6500, lng: 0.1500 },
  'angouleme': { lat: 45.6500, lng: 0.1500 },
  'pÃ©rigueux': { lat: 45.1833, lng: 0.7167 },
  'perigueux': { lat: 45.1833, lng: 0.7167 },
  'bergerac': { lat: 44.8500, lng: 0.4833 },
  'sarlat-la-canÃ©da': { lat: 44.8894, lng: 1.2164 },
  'libourne': { lat: 44.9167, lng: -0.2333 },
  'langon': { lat: 44.5531, lng: -0.2500 },
  'lesparre-mÃ©doc': { lat: 45.3058, lng: -0.9367 },
  'mont-de-marsan': { lat: 43.8900, lng: -0.5000 },
  'dax': { lat: 43.7103, lng: -1.0536 },
  'agen': { lat: 44.2033, lng: 0.6167 },
  'villeneuve-sur-lot': { lat: 44.4086, lng: 0.7053 },
  'marmande': { lat: 44.5000, lng: 0.1667 },
  'auch': { lat: 43.6456, lng: 0.5856 },
  'tarbes': { lat: 43.2333, lng: 0.0833 },
  'lannemezan': { lat: 43.1264, lng: 0.3833 },
  'bagnÃ¨res-de-bigorre': { lat: 43.0647, lng: 0.1500 },
  'foix': { lat: 42.9667, lng: 1.6000 },
  'pamiers': { lat: 43.1167, lng: 1.6167 },
  'saint-girons': { lat: 42.9833, lng: 1.1500 },
  'castres': { lat: 43.6000, lng: 2.2500 },
  'mazamet': { lat: 43.4922, lng: 2.3742 },
  'cahors': { lat: 44.4500, lng: 1.4333 },
  'figeac': { lat: 44.6086, lng: 2.0322 },
  'montauban': { lat: 44.0167, lng: 1.3500 },
  'castelsarrasin': { lat: 44.0400, lng: 1.1067 },
  'moissac': { lat: 44.1044, lng: 1.0850 },
  'sÃ¨te': { lat: 43.4053, lng: 3.6975 },
  'sete': { lat: 43.4053, lng: 3.6975 },
  'lunel': { lat: 43.6744, lng: 4.1361 },
  'narbonne': { lat: 43.1833, lng: 3.0000 },
  'limoux': { lat: 43.0544, lng: 2.2172 },
  'prades': { lat: 42.6167, lng: 2.4167 },
  'cÃ©ret': { lat: 42.4861, lng: 2.7486 },
  'alÃ¨s': { lat: 44.1258, lng: 4.0817 },
  'ales': { lat: 44.1258, lng: 4.0817 },
  'le vigan': { lat: 43.9917, lng: 3.6069 },
  'uzÃ¨s': { lat: 44.0122, lng: 4.4214 },
  'uzes': { lat: 44.0122, lng: 4.4214 },
  'arles': { lat: 43.6767, lng: 4.6278 },
  'salon-de-provence': { lat: 43.6406, lng: 5.0972 },
  'istres': { lat: 43.5147, lng: 4.9872 },
  'martigues': { lat: 43.4050, lng: 5.0475 },
  'la ciotat': { lat: 43.1747, lng: 5.6044 },
  'aubagne': { lat: 43.2922, lng: 5.5708 },
  'apt': { lat: 43.8769, lng: 5.3967 },
  'carpentras': { lat: 44.0550, lng: 5.0489 },
  'orange': { lat: 44.1386, lng: 4.8058 },
  'cavaillon': { lat: 43.8375, lng: 5.0381 },
  'digne-les-bains': { lat: 44.0925, lng: 6.2356 },
  'manosque': { lat: 43.8283, lng: 5.7869 },
  'sisteron': { lat: 44.2000, lng: 5.9333 },
  'gap': { lat: 44.5594, lng: 6.0786 },
  'brianÃ§on': { lat: 44.8958, lng: 6.6392 },
  'briancon': { lat: 44.8958, lng: 6.6392 },
  'embrun': { lat: 44.5636, lng: 6.4958 },
  'grasse': { lat: 43.6589, lng: 6.9225 },
  'menton': { lat: 43.7764, lng: 7.5028 },
  'frÃ©jus': { lat: 43.4331, lng: 6.7369 },
  'frejus': { lat: 43.4331, lng: 6.7369 },
  'draguignan': { lat: 43.5372, lng: 6.4647 },
  'hyÃ¨res': { lat: 43.1203, lng: 6.1286 },
  'hyeres': { lat: 43.1203, lng: 6.1286 },
  'saint-tropez': { lat: 43.2727, lng: 6.6407 },
  'brignoles': { lat: 43.4058, lng: 6.0619 },
  'albertville': { lat: 45.6758, lng: 6.3925 },
  'saint-jean-de-maurienne': { lat: 45.2750, lng: 6.3500 },
  'aix-les-bains': { lat: 45.6886, lng: 5.9153 },
  'thonon-les-bains': { lat: 46.3706, lng: 6.4797 },
  'Ã©vian-les-bains': { lat: 46.4008, lng: 6.5892 },
  'chamonix': { lat: 45.9237, lng: 6.8694 },
  'bonneville': { lat: 46.0789, lng: 6.4072 },
  'cluses': { lat: 46.0606, lng: 6.5797 },
  'sallanches': { lat: 45.9361, lng: 6.6306 },
  'megÃ¨ve': { lat: 45.8567, lng: 6.6175 },
  'megeve': { lat: 45.8567, lng: 6.6175 },
  'romans-sur-isÃ¨re': { lat: 45.0436, lng: 5.0525 },
  'montÃ©limar': { lat: 44.5581, lng: 4.7508 },
  'montelimar': { lat: 44.5581, lng: 4.7508 },
  'die': { lat: 44.7522, lng: 5.3708 },
  'nyons': { lat: 44.3622, lng: 5.1397 },
  'crest': { lat: 44.7292, lng: 5.0236 },
  'privas': { lat: 44.7358, lng: 4.5986 },
  'aubenas': { lat: 44.6208, lng: 4.3906 },
  'annonay': { lat: 45.2400, lng: 4.6708 },
  'tournon-sur-rhÃ´ne': { lat: 45.0669, lng: 4.8328 },
  'saint-chamond': { lat: 45.4800, lng: 4.5167 },
  'firminy': { lat: 45.3875, lng: 4.2906 },
  'roanne': { lat: 46.0333, lng: 4.0667 },
  'montbrison': { lat: 45.6072, lng: 4.0636 },
  'feurs': { lat: 45.7333, lng: 4.2333 },
  'saint-just-saint-rambert': { lat: 45.5000, lng: 4.2333 },
  'villefranche-sur-saÃ´ne': { lat: 45.9900, lng: 4.7200 },
  'tarare': { lat: 45.8967, lng: 4.4331 },
  'givors': { lat: 45.5900, lng: 4.7700 },
  'vienne': { lat: 45.5250, lng: 4.8783 },
  'bourgoin-jallieu': { lat: 45.5856, lng: 5.2739 },
  'voiron': { lat: 45.3650, lng: 5.5908 },
  'la tour-du-pin': { lat: 45.5656, lng: 5.4442 },
  'vienne': { lat: 45.5250, lng: 4.8783 },
  'beaune': { lat: 47.0258, lng: 4.8400 },
  'chalon-sur-saÃ´ne': { lat: 46.7833, lng: 4.8500 },
  'le creusot': { lat: 46.8000, lng: 4.4333 },
  'mÃ¢con': { lat: 46.3069, lng: 4.8286 },
  'macon': { lat: 46.3069, lng: 4.8286 },
  'autun': { lat: 46.9517, lng: 4.2986 },
  'sens': { lat: 48.1978, lng: 3.2833 },
  'joigny': { lat: 47.9833, lng: 3.4000 },
  'avallon': { lat: 47.4903, lng: 3.9069 },
  'tonnerre': { lat: 47.8567, lng: 3.9744 },
  'montbÃ©liard': { lat: 47.5100, lng: 6.7983 },
  'montbeliard': { lat: 47.5100, lng: 6.7983 },
  'pontarlier': { lat: 46.9069, lng: 6.3539 },
  'morteau': { lat: 47.0567, lng: 6.6072 },
  'gray': { lat: 47.4453, lng: 5.5897 },
  'luxeuil-les-bains': { lat: 47.8186, lng: 6.3817 },
  'lure': { lat: 47.6833, lng: 6.5000 },
  'saint-diÃ©-des-vosges': { lat: 48.2833, lng: 6.9500 },
  'remiremont': { lat: 48.0167, lng: 6.5833 },
  'gÃ©rardmer': { lat: 48.0736, lng: 6.8783 },
  'gerardmer': { lat: 48.0736, lng: 6.8783 },
  'bar-le-duc': { lat: 48.7667, lng: 5.1667 },
  'verdun': { lat: 49.1600, lng: 5.3833 },
  'commercy': { lat: 48.7622, lng: 5.5917 },
  'lunÃ©ville': { lat: 48.5936, lng: 6.4967 },
  'luneville': { lat: 48.5936, lng: 6.4967 },
  'toul': { lat: 48.6756, lng: 5.8911 },
  'pont-Ã -mousson': { lat: 48.9050, lng: 6.0533 },
  'briey': { lat: 49.2500, lng: 5.9333 },
  'longwy': { lat: 49.5211, lng: 5.7644 },
  'thionville': { lat: 49.3583, lng: 6.1667 },
  'forbach': { lat: 49.1833, lng: 6.9000 },
  'sarreguemines': { lat: 49.1100, lng: 7.0700 },
  'saint-avold': { lat: 49.1044, lng: 6.7072 },
  'sarrebourg': { lat: 48.7358, lng: 7.0533 },
  'saverne': { lat: 48.7417, lng: 7.3628 },
  'haguenau': { lat: 48.8167, lng: 7.7833 },
  'sÃ©lestat': { lat: 48.2597, lng: 7.4531 },
  'selestat': { lat: 48.2597, lng: 7.4531 },
  'obernai': { lat: 48.4617, lng: 7.4819 },
  'molsheim': { lat: 48.5417, lng: 7.4931 },
  'wissembourg': { lat: 49.0397, lng: 7.9456 },
  'altkirch': { lat: 47.6231, lng: 7.2394 },
  'guebwiller': { lat: 47.9092, lng: 7.2119 },
  'thann': { lat: 47.8092, lng: 7.1028 },
  'saint-louis': { lat: 47.5903, lng: 7.5614 },
  'soissons': { lat: 49.3817, lng: 3.3236 },
  'chÃ¢teau-thierry': { lat: 49.0464, lng: 3.4031 },
  'laon': { lat: 49.5633, lng: 3.6200 },
  'saint-quentin': { lat: 49.8467, lng: 3.2875 },
  'compiÃ¨gne': { lat: 49.4178, lng: 2.8261 },
  'compiegne': { lat: 49.4178, lng: 2.8261 },
  'beauvais': { lat: 49.4294, lng: 2.0800 },
  'creil': { lat: 49.2564, lng: 2.4742 },
  'senlis': { lat: 49.2069, lng: 2.5856 },
  'noyon': { lat: 49.5817, lng: 3.0003 },
  'clermont': { lat: 49.3794, lng: 2.4144 },
  'arras': { lat: 50.2917, lng: 2.7775 },
  'lens': { lat: 50.4333, lng: 2.8333 },
  'bÃ©thune': { lat: 50.5300, lng: 2.6400 },
  'bethune': { lat: 50.5300, lng: 2.6400 },
  'boulogne-sur-mer': { lat: 50.7264, lng: 1.6147 },
  'saint-omer': { lat: 50.7500, lng: 2.2500 },
  'montreuil-sur-mer': { lat: 50.4636, lng: 1.7636 },
  'douai': { lat: 50.3714, lng: 3.0800 },
  'valenciennes': { lat: 50.3500, lng: 3.5167 },
  'cambrai': { lat: 50.1761, lng: 3.2356 },
  'maubeuge': { lat: 50.2778, lng: 3.9731 },
  'avesnes-sur-helpe': { lat: 50.1228, lng: 3.9361 },
  'charleville-mÃ©ziÃ¨res': { lat: 49.7719, lng: 4.7161 },
  'charleville-mezieres': { lat: 49.7719, lng: 4.7161 },
  'sedan': { lat: 49.7019, lng: 4.9400 },
  'rethel': { lat: 49.5094, lng: 4.3672 },
  'vouziers': { lat: 49.3983, lng: 4.7014 },
  'Ã©pernay': { lat: 49.0400, lng: 3.9500 },
  'epernay': { lat: 49.0400, lng: 3.9500 },
  'chÃ¢lons-en-champagne': { lat: 48.9567, lng: 4.3631 },
  'chalons-en-champagne': { lat: 48.9567, lng: 4.3631 },
  'vitry-le-franÃ§ois': { lat: 48.7256, lng: 4.5844 },
  'sainte-menehould': { lat: 49.0900, lng: 4.8981 },
  'saint-dizier': { lat: 48.6361, lng: 4.9489 },
  'chaumont': { lat: 48.1117, lng: 5.1389 },
  'langres': { lat: 47.8628, lng: 5.3331 },
  'saint-mihiel': { lat: 48.8886, lng: 5.5494 },
  'meaux': { lat: 48.9603, lng: 2.8783 },
  'melun': { lat: 48.5397, lng: 2.6608 },
  'fontainebleau': { lat: 48.4050, lng: 2.7019 },
  'provins': { lat: 48.5600, lng: 3.2992 },
  'nemours': { lat: 48.2644, lng: 2.6928 },
  'montereau-fault-yonne': { lat: 48.3831, lng: 2.9508 },
  'versailles': { lat: 48.8014, lng: 2.1301 },
  'saint-germain-en-laye': { lat: 48.8989, lng: 2.0938 },
  'rambouillet': { lat: 48.6439, lng: 1.8308 },
  'mantes-la-jolie': { lat: 48.9906, lng: 1.7169 },
  'poissy': { lat: 48.9283, lng: 2.0489 },
  'pontoise': { lat: 49.0500, lng: 2.1000 },
  'argenteuil': { lat: 48.9472, lng: 2.2467 },
  'sarcelles': { lat: 48.9956, lng: 2.3808 },
  'Ã©vry': { lat: 48.6244, lng: 2.4503 },
  'evry': { lat: 48.6244, lng: 2.4503 },
  'corbeil-essonnes': { lat: 48.6139, lng: 2.4828 },
  'Ã©tampes': { lat: 48.4347, lng: 2.1617 },
  'palaiseau': { lat: 48.7144, lng: 2.2456 },
  'nanterre': { lat: 48.8922, lng: 2.2069 },
  'antony': { lat: 48.7536, lng: 2.2972 },
  'crÃ©teil': { lat: 48.7833, lng: 2.4667 },
  'creteil': { lat: 48.7833, lng: 2.4667 },
  'nogent-sur-marne': { lat: 48.8369, lng: 2.4828 },
  'vincennes': { lat: 48.8478, lng: 2.4392 },
  'saint-maur-des-fossÃ©s': { lat: 48.7997, lng: 2.4997 },
  'bobigny': { lat: 48.9106, lng: 2.4397 },
  'saint-ouen': { lat: 48.9122, lng: 2.3342 },
  'pantin': { lat: 48.8933, lng: 2.4075 },
  'aubervilliers': { lat: 48.9133, lng: 2.3825 },
  'bondy': { lat: 48.9022, lng: 2.4833 },
  'aulnay-sous-bois': { lat: 48.9386, lng: 2.4956 },
  'livry-gargan': { lat: 48.9206, lng: 2.5389 },
  'villepinte': { lat: 48.9567, lng: 2.5433 },
  'tremblay-en-france': { lat: 48.9567, lng: 2.5656 },
  'le raincy': { lat: 48.8983, lng: 2.5194 },
  'neuilly-sur-seine': { lat: 48.8850, lng: 2.2681 },
  'courbevoie': { lat: 48.8967, lng: 2.2567 },
  'colombes': { lat: 48.9233, lng: 2.2525 },
  'asniÃ¨res-sur-seine': { lat: 48.9133, lng: 2.2833 },
  'rueil-malmaison': { lat: 48.8769, lng: 2.1894 },
  'levallois-perret': { lat: 48.8933, lng: 2.2878 },
  'issy-les-moulineaux': { lat: 48.8239, lng: 2.2700 },
  'clamart': { lat: 48.8000, lng: 2.2656 },
  'meudon': { lat: 48.8133, lng: 2.2350 },
  'sÃ¨vres': { lat: 48.8231, lng: 2.2106 },
  'sevres': { lat: 48.8231, lng: 2.2106 },
  'boulogne-billancourt': { lat: 48.8397, lng: 2.2399 },
  'saint-cloud': { lat: 48.8456, lng: 2.2156 },
  'suresnes': { lat: 48.8717, lng: 2.2286 },
  'puteaux': { lat: 48.8850, lng: 2.2389 },
  'la dÃ©fense': { lat: 48.8918, lng: 2.2378 },
  'la defense': { lat: 48.8918, lng: 2.2378 },
  'cergy': { lat: 49.0361, lng: 2.0631 },
  'saint-quentin-en-yvelines': { lat: 48.7867, lng: 2.0333 },
  'vÃ©lizy-villacoublay': { lat: 48.7833, lng: 2.1833 },
  'le chesnay': { lat: 48.8231, lng: 2.1242 },
  'chatou': { lat: 48.8897, lng: 2.1578 },
  'maisons-laffitte': { lat: 48.9500, lng: 2.1500 },
  'sartrouville': { lat: 48.9394, lng: 2.1625 },
  'houilles': { lat: 48.9256, lng: 2.1897 },
  'carriÃ¨res-sur-seine': { lat: 48.9083, lng: 2.1789 },
  'conflans-sainte-honorine': { lat: 49.0017, lng: 2.0956 },
  'herblay': { lat: 49.0000, lng: 2.1667 },
  'franconville': { lat: 48.9875, lng: 2.2314 },
  'ermont': { lat: 48.9917, lng: 2.2578 },
  'eaubonne': { lat: 48.9917, lng: 2.2833 },
  'montmorency': { lat: 48.9917, lng: 2.3167 },
  'enghien-les-bains': { lat: 48.9706, lng: 2.3083 },
  'epinay-sur-seine': { lat: 48.9553, lng: 2.3094 },
  'villetaneuse': { lat: 48.9569, lng: 2.3428 },
  'pierrefitte-sur-seine': { lat: 48.9644, lng: 2.3597 },
  'stains': { lat: 48.9500, lng: 2.3833 },
  'la courneuve': { lat: 48.9286, lng: 2.3969 },
  'drancy': { lat: 48.9300, lng: 2.4500 },
  'le blanc-mesnil': { lat: 48.9386, lng: 2.4614 },
  'sevran': { lat: 48.9500, lng: 2.5333 },
  'gagny': { lat: 48.8833, lng: 2.5333 },
  'noisy-le-grand': { lat: 48.8500, lng: 2.5500 },
  'chelles': { lat: 48.8833, lng: 2.6000 },
  'torcy': { lat: 48.8500, lng: 2.6500 },
  'lognes': { lat: 48.8333, lng: 2.6333 },
  'marne-la-vallÃ©e': { lat: 48.8425, lng: 2.7275 },
  'marne-la-vallee': { lat: 48.8425, lng: 2.7275 },
  'pontault-combault': { lat: 48.8000, lng: 2.6000 },
  'roissy-en-brie': { lat: 48.7917, lng: 2.6500 },
  'ozoir-la-ferriÃ¨re': { lat: 48.7667, lng: 2.6667 },
  'bussy-saint-georges': { lat: 48.8425, lng: 2.7000 },
  'lagny-sur-marne': { lat: 48.8731, lng: 2.7117 },
  'coulommiers': { lat: 48.8128, lng: 3.0856 },
  'la fertÃ©-sous-jouarre': { lat: 48.9500, lng: 3.1333 },
  'Ã®le-de-france': { lat: 48.8499, lng: 2.6370 },
  'ile-de-france': { lat: 48.8499, lng: 2.6370 },
};

// CoordonnÃ©es par rÃ©gion (fallback)
const REGION_COORDS = {
  'ÃŽle-de-France': { lat: 48.8499, lng: 2.6370 },
  'Auvergne-RhÃ´ne-Alpes': { lat: 45.4473, lng: 4.3859 },
  'Nouvelle-Aquitaine': { lat: 44.8486, lng: -0.5561 },
  'Occitanie': { lat: 43.8927, lng: 2.2894 },
  'Hauts-de-France': { lat: 49.9659, lng: 2.7982 },
  'Provence-Alpes-CÃ´te d\'Azur': { lat: 43.9352, lng: 6.0679 },
  'Grand Est': { lat: 48.6998, lng: 5.7693 },
  'Pays de la Loire': { lat: 47.7633, lng: -0.3296 },
  'Bretagne': { lat: 48.2020, lng: -2.9326 },
  'Normandie': { lat: 49.1829, lng: -0.3707 },
  'Bourgogne-Franche-ComtÃ©': { lat: 47.2805, lng: 4.9994 },
  'Centre-Val de Loire': { lat: 47.7516, lng: 1.6751 },
  'Corse': { lat: 42.0396, lng: 9.0129 },
};

async function main() {
  console.log('ðŸ—ºï¸  GÃ©ocodage des marques...\n');

  const brands = await prisma.brand.findMany({
    where: {
      OR: [
        { latitude: null },
        { longitude: null },
      ],
    },
    include: {
      region: true,
    },
  });

  console.log(`   ${brands.length} marques sans coordonnÃ©es\n`);

  let updated = 0;
  let notFound = 0;

  for (const brand of brands) {
    let coords = null;

    // 1. Essayer avec la ville
    if (brand.city) {
      const cityKey = brand.city.toLowerCase().trim();
      coords = CITY_COORDS[cityKey];
      
      // Essayer des variations
      if (!coords) {
        const cityNormalized = cityKey
          .normalize('NFD')
          .replace(/[\u0300-\u036f]/g, '')
          .replace(/[^a-z\s-]/g, '');
        coords = CITY_COORDS[cityNormalized];
      }
    }

    // 2. Fallback sur la rÃ©gion
    if (!coords && brand.region) {
      coords = REGION_COORDS[brand.region.name];
      if (coords) {
        // Ajouter un peu de variation pour Ã©viter que toutes les marques soient au mÃªme endroit
        coords = {
          lat: coords.lat + (Math.random() - 0.5) * 0.5,
          lng: coords.lng + (Math.random() - 0.5) * 0.5,
        };
      }
    }

    if (coords) {
      await prisma.brand.update({
        where: { id: brand.id },
        data: {
          latitude: coords.lat,
          longitude: coords.lng,
        },
      });
      updated++;
      if (updated % 50 === 0) {
        console.log(`   ðŸ“ ${updated} marques gÃ©ocodÃ©es...`);
      }
    } else {
      notFound++;
      if (brand.city) {
        console.log(`   âš ï¸  Ville non trouvÃ©e: ${brand.city} (${brand.name})`);
      }
    }
  }

  console.log(`\nâœ… GÃ©ocodage terminÃ© !`);
  console.log(`   - ${updated} marques mises Ã  jour`);
  console.log(`   - ${notFound} villes non trouvÃ©es`);

  // Stats finales
  const withCoords = await prisma.brand.count({
    where: {
      latitude: { not: null },
      longitude: { not: null },
    },
  });
  const total = await prisma.brand.count();

  console.log(`\nðŸ“Š ${withCoords}/${total} marques ont des coordonnÃ©es`);
}

main()
  .catch((e) => {
    console.error('âŒ Erreur:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });